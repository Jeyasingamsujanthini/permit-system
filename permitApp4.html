<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events Permit</title>
    <link rel="stylesheet" href="/e-permit-system/frontend/assets/css/style.css">
    <style>
      .logout-btn{
        background: #1d273a;
        color: white;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 6px;
        cursor: pointer;
        transition: 0.3s;
        box-shadow: 0 2px 5px white;
    }

    .logout-btn:hover{
        background: navy;
        transform: scale(1.05);
    }
    </style>
</head>
<body>
    <header class="navbar">
    <div class="logo">E-Permit</div>
    <nav>
      <a href="../index.html">Home</a>
      <a href="permit.html">Dashboard</a>
      <!-- Logout Button -->
<button class="logout-btn"  onclick="logoutUser()">Logout</button>

<script>
  function logoutUser() {
    // Show alert
    alert("Successfully logout your account");

    // Redirect to homepage
    window.location.href = "../index.html";
  }
</script>
    </nav>
  </header>
    <section class="buildingPermit">
    <h2>Event Permission Application Form</h2>
    <form action="/backend/submit_permit.php" method="post" class="permit-form">
      <!-- fixed value to tell backend what permit type-->
      <input type="hidden" name="permit_type" value="event">

      <label for="applicantName">Applicant Name:</label>
      <input type="text" id="applicantName" name="applicantName" required>

      <label for="nicNo">NIC / Passport No:</label>
      <input type="text" id="nicNo" name="nicNo" required>

      <label for="contactNumber">Contact Number:</label>
      <input type="tel" id="contactNumber" name="contactNumber" required>

      <label for="email">Email Address:</label>
      <input type="email" id="email" name="email" required>

      <label for="address">Residential Address:</label>
      <input type="text" id="address" name="address" required>

      <!-- Organization Details -->
      <label for="organization">Organization / Event Organizer Name:</label>
      <input type="text" id="organization" name="organization">

      <label for="orgType">Type of Organization:</label>
      <select id="orgType" name="orgType">
        <option value="">Select Type</option>
        <option value="sole">Sole Proprietorship</option>
        <option value="partnership">Partnership</option>
        <option value="corporation">Corporation</option>
        <option value="ngo">Non-Profit / NGO</option>
        <option value="other">Other</option>
      </select>

      <!-- Event Details -->
      <label for="eventName">Event Name:</label>
      <input type="text" id="eventName" name="eventName" required>

      <label for="eventType">Event Type:</label>
      <select id="eventType" name="eventType" required>
        <option value="">Select Type</option>
        <option value="cultural">Cultural</option>
        <option value="religious">Religious</option>
        <option value="sports">Sports</option>
        <option value="private">Private / Social</option>
        <option value="other">Other</option>
      </select>

      <label for="eventLocation">Event Location / Venue:</label>
      <input type="text" id="eventLocation" name="eventLocation" required>

      <label for="province">Province:</label>
      <select id="province" name="province" required>
        <option value="">Select Province</option>
        <option value="central">Central</option>
        <option value="eastern">Eastern</option>
        <option value="northern">Northern</option>
        <option value="southern">Southern</option>
        <option value="western">Western</option>
        <option value="northWestern">North Western</option>
        <option value="northCentral">North Central</option>
        <option value="uva">Uva</option>
        <option value="sabaragamuwa">Sabaragamuwa</option>
      </select>

      <label for="district">District:</label>
      <select id="district" name="district" required>
        <option value="">Select District</option>
        <option value="Colombo">Colombo</option>
        <option value="Gampaha">Gampaha</option>
        <option value="Kalutara">Kalutara</option>
        <option value="Kandy">Kandy</option>
        <option value="Matale">Matale</option>
        <option value="Nuwara-Eliya">Nuwara Eliya</option>
        <option value="Galle">Galle</option>
        <option value="Matara">Matara</option>
        <option value="Hambantota">Hambantota</option>
        <option value="Jaffna">Jaffna</option>
        <option value="Kilinochchi">Kilinochchi</option>
        <option value="Mannar">Mannar</option>
        <option value="Vavuniya">Vavuniya</option>
        <option value="Mullaitivu">Mullaitivu</option>
        <option value="Batticaloa">Batticaloa</option>
        <option value="Ampara">Ampara</option>
        <option value="Trincomalee">Trincomalee</option>
        <option value="Kurunegala">Kurunegala</option>
        <option value="Puttalam">Puttalam</option>
        <option value="Anuradhapura">Anuradhapura</option>
        <option value="Polonnaruwa">Polonnaruwa</option>
        <option value="Badulla">Badulla</option>
        <option value="Monaragala">Monaragala</option>
        <option value="Ratnapura">Ratnapura</option>
        <option value="Kegalle">Kegalle</option>
      </select>

      
      <label for="startDate">Event Start Date:</label>
      <input type="date" id="startDate" name="startDate" required>

      <label for="startTime">Event Start Time:</label>
      <input type="time" id="starttime" name="starttime" required>

      <label for="endDate">Event End Date:</label>
      <input type="date" id="endDate" name="endDate" required>

      <label for="endTime">Event End Time:</label>
      <input type="time" id="endtime" name="endtime" required>

      <label for="expectedAttendees">Expected Number of Attendees:</label>
      <input type="number" id="expectedAttendees" name="expectedAttendees" required>

      <label for="description">Event Description:</label>
      <textarea id="description" name="description" rows="4" required></textarea>

      <label for="documents">Upload Supporting Documents (layout, approvals, insurance):</label>
      <input type="file" id="documents" name="documents" multiple required>

      <button type="submit">Submit Application</button>
    </form>
  </section>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.querySelector(".event-form");

      form.addEventListener("submit", (event) => {
        event.preventDefault();

        const name = document.getElementById("applicantName").value.trim();
        const nic = document.getElementById("nicNo").value.trim();
        const contact = document.getElementById("contactNumber").value.trim();
        const startDate = document.getElementById("startDate").value;
        const endDate = document.getElementById("endDate").value;
        const attendees = document.getElementById("expectedAttendees").value;
        const files = document.getElementById("documents").files;

        // Name validation
        if (name.length < 3) {
          alert("Applicant name must be at least 3 characters.");
          return;
        }

        // NIC validation
        const nicPattern = /^([0-9]{9}[vVxX]|[0-9]{12})$/;
        if (!nicPattern.test(nic)) {
          alert("Invalid NIC format. Use 9 digits + V/X or 12 digits.");
          return;
        }

        // Contact validation
        const phonePattern = /^0\d{9}$/;
        if (!phonePattern.test(contact)) {
          alert("Invalid phone number. Must be 10 digits starting with 0.");
          return;
        }

        // Date validation
        if (new Date(startDate) > new Date(endDate)) {
          alert("End date must be after start date.");
          return;
        }

        // Attendees validation
        if (attendees <= 0) {
          alert("Expected attendees must be greater than 0.");
          return;
        }

        // File validation
        if (files.length === 0) {
          alert("Please upload supporting documents.");
          return;
        }

        alert("Event permission application submitted successfully âœ…");
        // form.submit(); // Uncomment when backend is ready
      });
    });
  </script>    
</body>
</html>